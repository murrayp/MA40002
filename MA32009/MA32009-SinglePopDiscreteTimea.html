<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Discrete Time single Pop</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="MA32009-SinglePopDiscreteTimea_files/libs/clipboard/clipboard.min.js"></script>
<script src="MA32009-SinglePopDiscreteTimea_files/libs/quarto-html/quarto.js"></script>
<script src="MA32009-SinglePopDiscreteTimea_files/libs/quarto-html/popper.min.js"></script>
<script src="MA32009-SinglePopDiscreteTimea_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="MA32009-SinglePopDiscreteTimea_files/libs/quarto-html/anchor.min.js"></script>
<link href="MA32009-SinglePopDiscreteTimea_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="MA32009-SinglePopDiscreteTimea_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="MA32009-SinglePopDiscreteTimea_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="MA32009-SinglePopDiscreteTimea_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="MA32009-SinglePopDiscreteTimea_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="MA32009-SinglePopDiscreteTimea.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Discrete Time single Pop</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="single-species-population-dynamics-in-discrete-time" class="level1">
<h1>Single species population dynamics in discrete time</h1>
<p>Let us firstly consider models of a single population defined at discrete times. Discrete (rather than continuous) time is used in population models where, for example, there are strong annual trends in the underlying animal behaviour (e.g.&nbsp;fish eggs hatching at a fixed time in the year), there are not overlapping generations and the population size at the next time step can be written as a function of the current population size.</p>
<section id="a-general-model-for-a-single-population-in-discrete-time" class="level2">
<h2 class="anchored" data-anchor-id="a-general-model-for-a-single-population-in-discrete-time">A general model for a single population in discrete time</h2>
<p>Let <span class="math inline">\(t\)</span> be an independent variable representing time and <span class="math inline">\(N_t\)</span> be a dependent variable representing the size of the population of a given species at time <span class="math inline">\(t\)</span>.</p>
<p>Consider the first order difference equation <span id="eq-GeneralPopulationModel"><span class="math display">\[
N_{t+1}=N_tf(N_t)=H(N_t),
\tag{1}\]</span></span> where <span class="math inline">\(f(N_t)\)</span> is a function that defines the per capita growth rate. The function <span class="math inline">\(H(N_t)\)</span> describes the total (net) growth rate.</p>
<p>Given some initial condition <span class="math inline">\(N_0\)</span> defined such that <span class="math display">\[
N_{t=0}=N_0,
\]</span> the goal of this section is to develop a range of techniques that allow us to analyse the behaviour of <a href="#eq-GeneralPopulationModel">Equation&nbsp;1</a> for a given <span class="math inline">\(H\)</span>.</p>
<p>Finally, note that many of you were introduced to difference equations in the module MA21003 Discrete Mathematics. It is recommended that you revisit the section on Discrete Difference Equations.</p>
</section>
<section id="the-malthusian-model" class="level2">
<h2 class="anchored" data-anchor-id="the-malthusian-model">The Malthusian model</h2>
<p>Perhaps the simplest form for equation <a href="#eq-GeneralPopulationModel">Equation&nbsp;1</a> is when the net per capita growth rate is a constant.</p>
<p>Let <span class="math inline">\(b\)</span> be the per capita growth rate and <span class="math inline">\(d\)</span> the per capita death rate with <span class="math inline">\(b\)</span> and <span class="math inline">\(d\)</span> both positive real constants.</p>
<p>Hence, a population of size <span class="math inline">\(N_t\)</span> at time <span class="math inline">\(t\)</span> will grow by <span class="math display">\[
bN_t
\]</span> over the course of the next iteration and decay by<br>
<span class="math display">\[
dN_t.
\]</span> Therefore the population size at time <span class="math inline">\(t+1\)</span> is <span id="eq-MalthusianEqn"><span class="math display">\[
N_{t+1}=N_t + bN_t - dN_t=rN_t,
\tag{2}\]</span></span> \end{align} where the parameter <span class="math inline">\(r=1+b-d\)</span> is known as the net growth rate.</p>
<p>Given the initial condition <span class="math inline">\(N_0\)</span>, equation <a href="#eq-MalthusianEqn">Equation&nbsp;2</a> can be solved recursively as follows:</p>
<p><span class="math display">\[
N_1=rN_0,
N_2=r(N_1)=r^2N_0,   
N_3=rN_2=r^3N_0, ...,    
N_t=r^tN_0.
\]</span> Hence for the case of Malthusian growth, the size of the population can be explicitly calculated for all <span class="math inline">\(t\)</span>.</p>
<p>In <a href="#fig-plotmalthusian">Figure&nbsp;1</a> a numerical solution of the model is computed for different values of the parameter <span class="math inline">\(r\)</span>.</p>
<div class="cell" data-execution_count="1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>T<span class="op">=</span><span class="dv">10</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.arange(<span class="dv">0</span>, T, <span class="dv">1</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> np.zeros_like(t,dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>N_2 <span class="op">=</span> np.zeros_like(t,dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>N_0<span class="op">=</span><span class="fl">3.0</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>r<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>r_2<span class="op">=</span><span class="fl">1.5</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rhs(x,r):</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  f<span class="op">=</span>r<span class="op">*</span>x</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> f</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> SolveSingleDiff(t,rhs,N_0,r):</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  N <span class="op">=</span> np.zeros_like(t,dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  N[<span class="dv">0</span>]<span class="op">=</span>N_0</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> i <span class="kw">in</span> t:</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i<span class="op">&gt;</span><span class="dv">0</span>:</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>      N[i]<span class="op">=</span>rhs(N[i<span class="op">-</span><span class="dv">1</span>],r) </span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> N</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>N<span class="op">=</span>SolveSingleDiff(t,rhs,N_0,r)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>N_2<span class="op">=</span>SolveSingleDiff(t,rhs,N_0,r_2)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(t, N)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$t$'</span>)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$N_t$'</span>)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(t, N_2)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$t$'</span>)</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$N_t$'</span>)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-plotmalthusian" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="MA32009-SinglePopDiscreteTimea_files/figure-html/fig-plotmalthusian-output-1.png" width="571" height="432" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;1: A plot of the Malthusian model solution when (a) <span class="math inline">\(r\)</span>=0.5 and (b) <span class="math inline">\(r\)</span>=1.5.</figcaption>
</figure>
</div>
</div>
</div>
<p>Can you describe the behaviour of the Malthusian model? How does it depend on the value of the parameter <span class="math inline">\(r\)</span>?</p>
<p>Qualitative analyses allows us to categorise solution behaviours into different cases. For example, note that the behaviour of the population at large <span class="math inline">\(t\)</span> is governed by the magnitude of the parameter <span class="math inline">\(r\)</span>.</p>
<p>As <span class="math inline">\(t\rightarrow \infty\)</span></p>
<p><span class="math display">\[
N \rightarrow
\left\{
\begin{array}{ll}
\infty &amp; r&gt;1  \\
N_0&amp; r=1  \\  
0 &amp; r&lt;1.     
\end{array} \right.
\]</span></p>
<p>In <a href="#fig-plotmalthusian">Figure&nbsp;1</a> solutions in each of the (nontrivial) parameter regimes are plotted. When <span class="math inline">\(r&lt;1\)</span> the population tends to zero and when <span class="math inline">\(r&gt;1\)</span> the population explodes.</p>
<p>Whilst the simplicity of the Malthusian model allows us to calculate explicit solutions that yield insight into how the processes of birth and death combine to give either net growth or net reduction in population size, an obvious flaw with this model is that it displays unbounded growth for <span class="math inline">\(r&gt;1\)</span>. In most biological systems, other effects, such as competition for resources or predation, will tend to limit a population’s size. In single species population models, these effects are accounted for phenomenologically by introducing nonlinear terms into the function <span class="math inline">\(f\)</span>.</p>
</section>
<section id="a-motivating-example-of-a-nonlinear-model---the-ricker-model" class="level2">
<h2 class="anchored" data-anchor-id="a-motivating-example-of-a-nonlinear-model---the-ricker-model">A motivating example of a nonlinear model - The Ricker model</h2>
<p>Many models of population dynamics in discrete time were initially developed to study fisheries. Well-studied examples include the Beverton Holt model <span class="math display">\[
N_{t+1}=\frac{rN_t}{1+\frac{N_t}{K}},
\]</span> the Hassell model <span class="math display">\[
N_{t+1}=\frac{rN_t}{(1+\frac{N_t}{K})^b},
\]</span> and the Ricker model <span class="math display">\[
N_{t+1}=N_te^{r(1-\frac{N_t}{K})}.
\]</span> where <span class="math inline">\(r\)</span>, <span class="math inline">\(K\)</span> and <span class="math inline">\(b\)</span> are positive parameters. Below we consider the Ricker model which was initially used to study Canadian sockeye salmon population dynamics.</p>
<section id="model-development" class="level3">
<h3 class="anchored" data-anchor-id="model-development">Model development</h3>
<p>One way to capture a decreased growth rate at high densities, is to assume that the per capita growth rate is an exponentially decreasing function of population density, i.e.&nbsp; <span class="math display">\[
f(N_t)=e^{r(1-\frac{N_t}{K})},
\]</span> where <span class="math inline">\(r\)</span> is a growth rate and <span class="math inline">\(K\)</span> a carrying capacity (both positive constants). Hence the governing equation is <span id="eq-RickerDefn1"><span class="math display">\[
N_{t+1}=N_te^{r(1-\frac{N_t}{K})}.
\tag{3}\]</span></span> Note that as the population size gets large (<span class="math inline">\(N_t\gg K\)</span>), the growth rate tends to zero but that for small populations <span class="math inline">\(N_t\ll K\)</span> the growth rate is approximately constant. This is the Ricker model.</p>
<p>Note that the model is nonlinear and does not have an explicit solution.</p>
</section>
<section id="computational-solutions" class="level3">
<h3 class="anchored" data-anchor-id="computational-solutions">Computational solutions</h3>
<p>After directly computing numerical solutions of the Ricker model for different values of the parameter <span class="math inline">\(r\)</span>, the data in <span class="citation" data-cites="plotricker">@plotricker</span> were obtained.</p>
<p>Note that model behaviour changes drastically as the parameter <span class="math inline">\(r\)</span> varies. For instance,</p>
<ul>
<li>when <span class="math inline">\(r=0.5\)</span> (<a href="#fig-plotricker">Figure&nbsp;2</a> (a)), the solution monotonically approaches the value <span class="math inline">\(2\)</span>, *
when <span class="math inline">\(r=1.5\)</span> (<a href="#fig-plotricker">Figure&nbsp;2</a> (b)) it approaches two in an oscillatory manner; and</li>
<li>when <span class="math inline">\(r=2.5\)</span> (<a href="#fig-plotricker">Figure&nbsp;2</a> (c)) it oscillates around two.</li>
</ul>
<p>The above numerical results raise the following questions:</p>
<ul>
<li>can we develop tools that allow us to qualitatively describe how the model solutions depend on model parameters?</li>
<li>are the there certain families of solutions with qualitatively similar behaviours?</li>
<li>how do such families of solutions depend on model parameters?</li>
</ul>
<p>We will return to analysis of the Ricker model in Worksheet 1.</p>
<div class="cell" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>r_1<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>r_2<span class="op">=</span><span class="fl">1.5</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>r_3<span class="op">=</span><span class="fl">2.5</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>K<span class="op">=</span><span class="fl">2.0</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>T<span class="op">=</span><span class="dv">20</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.arange(<span class="dv">0</span>, T, <span class="dv">1</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>N_1 <span class="op">=</span> np.zeros_like(t,dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>N_2 <span class="op">=</span> np.zeros_like(t,dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>N_3 <span class="op">=</span> np.zeros_like(t,dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rhs(x,r,K):</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  f<span class="op">=</span>x<span class="op">*</span>np.exp(r<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">/</span>K))</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> f</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> SolveSingleDiff(t,rhs,N_0,r,K):</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  N <span class="op">=</span> np.zeros_like(t,dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  N[<span class="dv">0</span>]<span class="op">=</span>N_0</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> i <span class="kw">in</span> t:</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i<span class="op">&gt;</span><span class="dv">0</span>:</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>      N[i]<span class="op">=</span>rhs(N[i<span class="op">-</span><span class="dv">1</span>],r,K) </span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> N</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>N_1<span class="op">=</span>SolveSingleDiff(t,rhs,N_0,r_1,K)</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>N_2<span class="op">=</span>SolveSingleDiff(t,rhs,N_0,r_2,K)</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>N_3<span class="op">=</span>SolveSingleDiff(t,rhs,N_0,r_3,K)</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">3</span>)</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(t, N_1)</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$t$'</span>)</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$N_t$'</span>)</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(t, N_2)</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$t$'</span>)</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$N_t$'</span>)</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].plot(t, N_3)</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$t$'</span>)</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$N_t$'</span>)</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-plotricker" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="MA32009-SinglePopDiscreteTimea_files/figure-html/fig-plotricker-output-1.png" width="571" height="429" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;2: A plot of numerical solutions of the Ricker model. (a)r=0.5. (b) r=1.5. (c) r=2.5.</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="general-techniques-for-analysing-nonlinear-difference-equations" class="level2">
<h2 class="anchored" data-anchor-id="general-techniques-for-analysing-nonlinear-difference-equations">General techniques for analysing nonlinear difference equations</h2>
<p>In this section we develop techniques that will be used to analyse first order, discrete-time models of the form <span id="eq-generaleqn"><span class="math display">\[
N_{t+1}=N_t f(N_t)=H(N_t).
\tag{4}\]</span></span></p>
<section id="computational-solutions-1" class="level3">
<h3 class="anchored" data-anchor-id="computational-solutions-1">Computational solutions</h3>
<p>Perhaps the most obvious way to investigate an equation of the form of <a href="#eq-generaleqn">Equation&nbsp;4</a> is to iteratively compute <span class="math inline">\(N_t\)</span> over a prescribed time range.</p>
<p>Hence given some initial population <span class="math inline">\(N_0\)</span>, the solution set <span class="math inline">\(\{N_0,N_1,N_2,...,N_T\}\)</span> is computed up to some end time <span class="math inline">\(T\)</span>. Such an approach provides a numerical solution for a given parameter set and initial condition. However, it does not provide much insight into the general behaviour of model.</p>
</section>
<section id="fixed-points" class="level3">
<h3 class="anchored" data-anchor-id="fixed-points">Fixed points</h3>
<p>We define <span class="math inline">\(N^*\)</span> to be a fixed point of <a href="#eq-generaleqn">Equation&nbsp;4</a> if and only if <span class="math display">\[
N^*=N^*f(N^*)=H(N^*).
\]</span> Hence the fixed points can be identified by solving an algebraic equation.</p>
</section>
<section id="linear-stability" class="level3">
<h3 class="anchored" data-anchor-id="linear-stability">Linear stability</h3>
<p>By linearising about the identified fixed points using a Taylor series expansion, it can be determined whether or not small perturbations around the fixed point grow or decay in subsequent iterations.</p>
<p>Making a change of dependent variables <span class="math display">\[
N_t=N^*+\hat{N_t}
\]</span> <a href="#eq-generaleqn">Equation&nbsp;4</a> transforms upon substitution to <span class="math display">\[
N^*+\hat{N}_{t+1} =  H(N^*+\hat{N}_t).
\]</span></p>
<p>Taylor expanding the right-hand side yields <span class="math display">\[
N^*+\hat{N}_{t+1}= H(N^*)+H'(N^*)\hat{N}_t + h.o.t. .
\]</span></p>
<p>Noting that at the fixed point <span class="math display">\[
N^*= H(N^*),
\]</span> cancellation yields <span class="math display">\[
\hat{N}_{t+1} = H'(N^*)\hat{N}_t + h.o.t.
\]</span> Hence considering only small perturbations about the fixed point, the leading order behaviour of the perturbation is governed by <span class="math display">\[
\hat{N}_{t} = (H'(N^*))^t\hat{N}_0.
\]</span></p>
<p>Hence the linear stability of the fixed point is governed by the sign and magnitude of the term <span class="math inline">\(H'(N^*)\)</span>. If <span class="math display">\[|H'(N^*)| &gt;1\]</span> the fixed point is unstable. Otherwise it it stable.</p>
</section>
<section id="cobwebbing-and-linear-stability" class="level3">
<h3 class="anchored" data-anchor-id="cobwebbing-and-linear-stability">Cobwebbing and linear stability</h3>
<p>A cobweb diagram allows solutions of a first order difference equation to be sketched without explicitly solving.</p>
<section id="algorithm-for-generating-a-cobweb-diagram" class="level4">
<h4 class="anchored" data-anchor-id="algorithm-for-generating-a-cobweb-diagram">Algorithm for generating a cobweb diagram</h4>
<p>The cobweb diagram is created as follows:</p>
<ul>
<li>Plot the <span class="math inline">\(t^{th}\)</span> iterate, <span class="math inline">\(N_t\)</span>, on the <span class="math inline">\(x\)</span> axis and the <span class="math inline">\(t+1^{st}\)</span>, <span class="math inline">\(N_{t+1}\)</span> on the <span class="math inline">\(y\)</span> axis.</li>
<li>Sketch the net growth rate function <span class="math inline">\(H(N_t)\)</span>.</li>
<li>Sketch the line <span class="math inline">\(N_{t+1}=N_t\)</span>.</li>
<li>Note any intersections between the straight line and the graph of <span class="math inline">\(H(N_t)\)</span> are fixed points.</li>
<li>Plot the first point <span class="math inline">\((N_0, H(N_0))\)</span> on the cobweb diagram.</li>
<li>Plot a horizontal line between <span class="math inline">\((N_0, H(N_0))\)</span> and <span class="math inline">\((H(N_0),H(N_0))\)</span>. Note <span class="math inline">\(N_1=H(N_0)\)</span>.</li>
<li>Plot a vertical line between <span class="math inline">\((N_1,N_1)\)</span> and <span class="math inline">\((N_1,H(N_1))\)</span>. *Repeat steps 6 and 7.</li>
</ul>
<p>Plotting cobweb diagrams in the vicinity of a fixed point <span class="math inline">\(N^*\)</span> for different values of <span class="math inline">\(H'(N^*)\)</span> allows us to see graphically how the derivative of the right-hand side affects linear stability of a fixed point (see Figure <span class="math inline">\(\ref{LinearStabilityDemo}\)</span>). In particular,</p>
<ul>
<li>when <span class="math inline">\(H'(N^*)&gt;1\)</span>, the fixed point is monotonically unstable;</li>
<li>when <span class="math inline">\(0&lt;H'(N^*)&lt;1\)</span>, the fixed point is monotonically stable;</li>
<li>when <span class="math inline">\(-1&lt;H'(N^*)&lt;0\)</span>, the fixed point is oscillatory stable;</li>
<li>when <span class="math inline">\(H'(N^*)=-1\)</span>, the fixed point is oscillatory; and</li>
<li>when <span class="math inline">\(H'(N^*)&lt;-1\)</span>, the fixed point is oscillatory unstable.</li>
</ul>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>T<span class="op">=</span><span class="dv">10</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.arange(<span class="dv">0</span>, T, <span class="dv">1</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> np.zeros_like(t,dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>N_2 <span class="op">=</span> np.zeros_like(t,dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>N_0<span class="op">=</span><span class="fl">2.4</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>r<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>r_2<span class="op">=</span><span class="fl">1.5</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>N_max<span class="op">=</span><span class="fl">2.5</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>N_min<span class="op">=</span><span class="fl">1.5</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rhs(x,r):</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  f<span class="op">=</span>r<span class="op">*</span>x<span class="op">+</span><span class="dv">1</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> f</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> SolveSingleDiff(t,rhs,N_0,r):</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  N <span class="op">=</span> np.zeros_like(t,dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  N[<span class="dv">0</span>]<span class="op">=</span>N_0</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  num_time_steps<span class="op">=</span>t.shape[<span class="dv">0</span>]</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  CobwebSol<span class="op">=</span>np.zeros((<span class="dv">2</span><span class="op">*</span>num_time_steps,<span class="dv">2</span>))</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  CobwebSol[<span class="dv">0</span>,<span class="dv">0</span>]<span class="op">=</span>N_0</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  CobwebSol[<span class="dv">0</span>,<span class="dv">1</span>]<span class="op">=</span>rhs(N_0,r)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  CobwebSol[<span class="dv">1</span>,<span class="dv">0</span>]<span class="op">=</span>CobwebSol[<span class="dv">0</span>,<span class="dv">1</span>]</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>  CobwebSol[<span class="dv">1</span>,<span class="dv">1</span>]<span class="op">=</span>CobwebSol[<span class="dv">0</span>,<span class="dv">1</span>]</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> i <span class="kw">in</span> t:</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i<span class="op">&gt;</span><span class="dv">0</span>:</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>      N[i]<span class="op">=</span>rhs(N[i<span class="op">-</span><span class="dv">1</span>],r) </span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>      sol_temp<span class="op">=</span>N[i<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>      rhs_temp<span class="op">=</span>rhs(sol_temp,r)</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>      CobwebSol[<span class="dv">2</span><span class="op">*</span>i,<span class="dv">0</span>]<span class="op">=</span>sol_temp</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>      CobwebSol[<span class="dv">2</span><span class="op">*</span>i,<span class="dv">1</span>]<span class="op">=</span>rhs_temp</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>      CobwebSol[<span class="dv">2</span><span class="op">*</span>i<span class="op">+</span><span class="dv">1</span>,<span class="dv">0</span>]<span class="op">=</span>rhs_temp</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>      CobwebSol[<span class="dv">2</span><span class="op">*</span>i<span class="op">+</span><span class="dv">1</span>,<span class="dv">1</span>]<span class="op">=</span>rhs_temp</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> N, CobwebSol</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>N,CobwebSol<span class="op">=</span>SolveSingleDiff(t,rhs,N_0,r)</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>N_plot<span class="op">=</span>np.linspace(N_min,N_max,<span class="dv">100</span>)</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>H_N_plot<span class="op">=</span>rhs(N_plot,r)</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>,<span class="dv">0</span>].plot([N_min, N_max], [N_min, N_max])</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>,<span class="dv">1</span>].plot([N_min, N_max], [N_min, N_max])</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>,<span class="dv">1</span>].plot(N_plot, H_N_plot)</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">0</span>].plot([N_min, N_max], [N_min, N_max])</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">0</span>].plot(N_plot, H_N_plot)</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">0</span>].plot(CobwebSol[<span class="dv">0</span>,<span class="dv">0</span>], CobwebSol[<span class="dv">0</span>,<span class="dv">1</span>],<span class="st">'*'</span>)</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">1</span>].plot([N_min, N_max], [N_min, N_max])</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">1</span>].plot(N_plot, H_N_plot)</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">1</span>].plot(CobwebSol[<span class="dv">0</span>:<span class="dv">5</span>,<span class="dv">0</span>], CobwebSol[<span class="dv">0</span>:<span class="dv">5</span>,<span class="dv">1</span>])</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>,<span class="dv">0</span>].plot([N_min, N_max], [N_min, N_max])</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>,<span class="dv">0</span>].plot(N_plot, H_N_plot)</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>,<span class="dv">0</span>].plot(CobwebSol[<span class="dv">0</span>:<span class="dv">7</span>,<span class="dv">0</span>], CobwebSol[<span class="dv">0</span>:<span class="dv">7</span>,<span class="dv">1</span>])</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>,<span class="dv">1</span>].plot([N_min, N_max], [N_min, N_max])</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>,<span class="dv">1</span>].plot(N_plot, H_N_plot)</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>,<span class="dv">1</span>].plot(CobwebSol[:,<span class="dv">0</span>], CobwebSol[:,<span class="dv">1</span>])</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$N_t$'</span>)</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$N_{t+1}$'</span>)</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-cobwebstepbystep" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="MA32009-SinglePopDiscreteTimea_files/figure-html/fig-cobwebstepbystep-output-1.png" width="575" height="431" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;3: Generating a cobweb plot.</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="bifurcation-diagrams" class="level3">
<h3 class="anchored" data-anchor-id="bifurcation-diagrams">Bifurcation diagrams</h3>
<p>A bifurcation is a qualitative change in solution behaviour (either a change in the number of fixed points or their stability). A bifurcation diagram is a compact means of describing bifurcations as a function of model parameters. Usually, the fixed point value of the population (i.e.&nbsp;<span class="math inline">\(N^*\)</span>) is plotted against a model parameter of interest. From this diagram one can immediately see how the number of fixed points and their stability changes as a given parameter increases.</p>
</section>
<section id="perform-a-qualitative-analysis-on-the-matlhusian-model" class="level3">
<h3 class="anchored" data-anchor-id="perform-a-qualitative-analysis-on-the-matlhusian-model">Perform a qualitative analysis on the Matlhusian model</h3>
<p>Let’s work through the various concepts introduced above using the Malthusian model (<a href="#eq-MalthusianEqn">Equation&nbsp;2</a>).</p>
<p>The fixed points satisfy <span class="math display">\[
N^*=rN^*.
\]</span> As <span class="math inline">\(r&gt;0\)</span> the only solution is <span class="math inline">\(N^*=0\)</span>.</p>
<p>In this case <span class="math display">\[
H'(N_t)=r.
\]</span> Hence the linear stability of the solution depends on the value of the parameter <span class="math inline">\(r\)</span> For <span class="math inline">\(r&gt;1\)</span> the fixed point <span class="math inline">\(N^*=0\)</span> is monotonically unstable. For <span class="math inline">\(r&lt;1\)</span> the fixed point <span class="math inline">\(N^*=0\)</span> is monotonically unstable. As expected this result is consistent with the simulation results in <a href="#fig-plotmalthusian">Figure&nbsp;1</a>.</p>
<p>For cobweb diagram:</p>
<ul>
<li>Sketch axes and label with <span class="math inline">\(N_t\)</span> and <span class="math inline">\(N_{t+1}\)</span>.</li>
<li>From linear stablity analysis note there are two qualitatively distinct cases (<span class="math inline">\(r&lt;1\)</span> and <span class="math inline">\(r&gt;1\)</span>). We will need a cobweb diagram for each case.</li>
<li>Case 1: graph the function <span class="math inline">\(H(N_t)\)</span>. In this case it is the straight line <span class="math inline">\(N_{t+1}=rN_t\)</span> with <span class="math inline">\(r&lt;1\)</span>.</li>
<li>Case 2: graph the function <span class="math inline">\(H(N_t)\)</span>. In this case it is the straight line <span class="math inline">\(N_{t+1}=rN_t\)</span> with <span class="math inline">\(r&gt;1\)</span>.</li>
<li>Fill in the cobwebbed trajectories with some arbitraily chosen initial condition.</li>
<li>Establish that behaviour of the cobweb is consistent with linear stability analysis.</li>
</ul>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>T<span class="op">=</span><span class="dv">10</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.arange(<span class="dv">0</span>, T, <span class="dv">1</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> np.zeros_like(t,dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>N_2 <span class="op">=</span> np.zeros_like(t,dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>N_0<span class="op">=</span><span class="fl">3.0</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>r<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>r_2<span class="op">=</span><span class="fl">1.5</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>N_max<span class="op">=</span><span class="fl">4.0</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rhs(x,r):</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  f<span class="op">=</span>r<span class="op">*</span>x</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> f</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> SolveSingleDiff(t,rhs,N_0,r):</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  N <span class="op">=</span> np.zeros_like(t,dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  N[<span class="dv">0</span>]<span class="op">=</span>N_0</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  num_time_steps<span class="op">=</span>t.shape[<span class="dv">0</span>]</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  CobwebSol<span class="op">=</span>np.zeros((<span class="dv">2</span><span class="op">*</span>num_time_steps,<span class="dv">2</span>))</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>  CobwebSol[<span class="dv">0</span>,<span class="dv">0</span>]<span class="op">=</span>N_0</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  CobwebSol[<span class="dv">0</span>,<span class="dv">1</span>]<span class="op">=</span>rhs(N_0,r)</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>  CobwebSol[<span class="dv">1</span>,<span class="dv">0</span>]<span class="op">=</span>CobwebSol[<span class="dv">0</span>,<span class="dv">1</span>]</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>  CobwebSol[<span class="dv">1</span>,<span class="dv">1</span>]<span class="op">=</span>CobwebSol[<span class="dv">0</span>,<span class="dv">1</span>]</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> i <span class="kw">in</span> t:</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i<span class="op">&gt;</span><span class="dv">0</span>:</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>      N[i]<span class="op">=</span>rhs(N[i<span class="op">-</span><span class="dv">1</span>],r) </span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>      sol_temp<span class="op">=</span>N[i<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>      rhs_temp<span class="op">=</span>rhs(sol_temp,r)</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>      CobwebSol[<span class="dv">2</span><span class="op">*</span>i,<span class="dv">0</span>]<span class="op">=</span>sol_temp</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>      CobwebSol[<span class="dv">2</span><span class="op">*</span>i,<span class="dv">1</span>]<span class="op">=</span>rhs_temp</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>      CobwebSol[<span class="dv">2</span><span class="op">*</span>i<span class="op">+</span><span class="dv">1</span>,<span class="dv">0</span>]<span class="op">=</span>rhs_temp</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>      CobwebSol[<span class="dv">2</span><span class="op">*</span>i<span class="op">+</span><span class="dv">1</span>,<span class="dv">1</span>]<span class="op">=</span>rhs_temp</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> N, CobwebSol</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>N,CobwebSol<span class="op">=</span>SolveSingleDiff(t,rhs,N_0,r)</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>N_plot<span class="op">=</span>np.linspace(<span class="dv">0</span>,N_max,<span class="dv">100</span>)</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>H_N_plot<span class="op">=</span>rhs(N_plot,r)</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(t, N)</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$t$'</span>)</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$N_t$'</span>)</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(CobwebSol[:,<span class="dv">0</span>], CobwebSol[:,<span class="dv">1</span>])</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(CobwebSol[<span class="dv">0</span>,<span class="dv">0</span>], CobwebSol[<span class="dv">0</span>,<span class="dv">1</span>],<span class="st">'*'</span>)</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot([<span class="dv">0</span>, N_max], [<span class="dv">0</span>, N_max])</span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(N_plot, H_N_plot)</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$N_t$'</span>)</span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$N_{t+1}$'</span>)</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-plotmalthusiancobweb" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="MA32009-SinglePopDiscreteTimea_files/figure-html/fig-plotmalthusiancobweb-output-1.png" width="571" height="431" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;4: A cobweb plot of the Malthusian model solution when <span class="math inline">\(r\)</span>=0.5. (a) Time series and (b) Cobweb diagrams.</figcaption>
</figure>
</div>
</div>
</div>
<p>For bifurcation diagram:</p>
<ul>
<li>We will plot the value of fixed point against a parameter of interest. In this case <span class="math inline">\(N^*\)</span> against <span class="math inline">\(r\)</span>.</li>
<li>Deduce from fixed point and linear stability analysis whether there are any changes in solution behaviour as <span class="math inline">\(r\)</span> varies (e.g.&nbsp;number of solution or their linear stability).</li>
<li>In this case the value of the fixed point is independent of <span class="math inline">\(r\)</span> but the the linear stability changes at <span class="math inline">\(r=1\)</span>. This is a bifurcation.</li>
<li>Use annotation to represent qualitative solution behaviour.</li>
</ul>
</section>
</section>
<section id="a-nonlinear-model-of-population-dynamics-in-discrete-time" class="level2">
<h2 class="anchored" data-anchor-id="a-nonlinear-model-of-population-dynamics-in-discrete-time">A nonlinear model of population dynamics in discrete time</h2>
<p>Consider a model of population growth given by</p>
<p><span id="eq-denslimgrowtheqn"><span class="math display">\[
N_{t+1}=\frac{\gamma N_t}{1+N_t^2},
\tag{5}\]</span></span> where <span class="math inline">\(\gamma\in \Re^+\)</span> is the linear growth rate.</p>
<section id="numerical-solution" class="level3">
<h3 class="anchored" data-anchor-id="numerical-solution">Numerical solution</h3>
<p>In <a href="#fig-plotdensmodel1">Figure&nbsp;5</a> time series solution of the model are plotted for parameter values <span class="math inline">\(\gamma=0.5\)</span>, <span class="math inline">\(\gamma=1.5\)</span>, <span class="math inline">\(\gamma=2.5\)</span>. Note qualitative changes in model behaviour in the different parameter regimes. Can you identify the fixed points? Are the solutions oscillatory?</p>
<div class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>T<span class="op">=</span><span class="dv">10</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.arange(<span class="dv">0</span>, T, <span class="dv">1</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>N_0<span class="op">=</span><span class="fl">3.0</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>gam_1<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>gam_2<span class="op">=</span><span class="fl">1.5</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>gam_3<span class="op">=</span><span class="fl">2.5</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rhs(x,r):</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  f<span class="op">=</span>r<span class="op">*</span>x<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> f</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> SolveSingleDiff(t,rhs,N_0,r):</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  N <span class="op">=</span> np.zeros_like(t,dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  N[<span class="dv">0</span>]<span class="op">=</span>N_0</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> i <span class="kw">in</span> t:</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i<span class="op">&gt;</span><span class="dv">0</span>:</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>      N[i]<span class="op">=</span>rhs(N[i<span class="op">-</span><span class="dv">1</span>],r) </span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> N</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>N_1<span class="op">=</span>SolveSingleDiff(t,rhs,N_0,gam_1)</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>N_2<span class="op">=</span>SolveSingleDiff(t,rhs,N_0,gam_2)</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>N_3<span class="op">=</span>SolveSingleDiff(t,rhs,N_0,gam_3)</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">3</span>)</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(t, N_1)</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$t$'</span>)</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$N_t$'</span>)</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(t, N_2)</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$t$'</span>)</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$N_t$'</span>)</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].plot(t, N_3)</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$t$'</span>)</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$N_t$'</span>)</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-plotdensmodel1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="MA32009-SinglePopDiscreteTimea_files/figure-html/fig-plotdensmodel1-output-1.png" width="571" height="429" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;5: Time series solution for (a) <span class="math inline">\(g\)</span>=0.5 and (b) <span class="math inline">\(g\)</span>=1.5 and (c) <span class="math inline">\(g\)</span>=10.5.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="fixed-points-1" class="level3">
<h3 class="anchored" data-anchor-id="fixed-points-1">Fixed points</h3>
<p>The fixed points satisfy the algebraic equation <span class="math display">\[
N^*=\frac{\gamma N^*}{1+{N^*}^2}
\]</span> which has solutions <span class="math display">\[
N^* = 0  \ \ \ \ \textrm{and} \ \ \ \ N^*=\sqrt{\gamma-1}.
\]</span></p>
<p>Sketch a graph of <span class="math inline">\(H(N_t)\)</span> against <span class="math inline">\(N_t\)</span> in the cases <span class="math inline">\(\gamma&lt;1\)</span> and <span class="math inline">\(\gamma&gt;1\)</span>.</p>
<p>Note that the per capita growth rate is described by the function <span class="math display">\[
f(N_{t})=\frac{\gamma}{1+N_t^2}.
\]</span> Hence at large populations the per capita growth rate tends to zero whilst for small populations it tends to <span class="math inline">\(\gamma\)</span>. Hence so long as <span class="math inline">\(\gamma&gt;1\)</span> we will have net growth for small populations and net removal for large populations. The net growth rate is given by <span class="math display">\[
H(N_{t})=\frac{\gamma N_t}{1+N_t^2}.
\]</span></p>
</section>
<section id="parameter-restrictions-for-biological-validity" class="level3">
<h3 class="anchored" data-anchor-id="parameter-restrictions-for-biological-validity">Parameter restrictions for biological validity</h3>
<p>If <span class="math inline">\(\gamma&lt;1\)</span>, there is only one biologically relevant fixed point. If <span class="math inline">\(\gamma &gt;1\)</span> there are two fixed-points, <span class="math inline">\(N^*=0\)</span> and <span class="math inline">\(N^*=\sqrt{\gamma-1}\)</span>. Hence the value of the model parameter <span class="math inline">\(\gamma\)</span> qualitatively affects the behaviour and number of solutions.</p>
<p>Sketch a graph of <span class="math inline">\(N^*\)</span> against <span class="math inline">\(\gamma\)</span>.</p>
<p>Roots: 0 TP:</p>
</section>
<section id="linear-stability-analysis" class="level3">
<h3 class="anchored" data-anchor-id="linear-stability-analysis">Linear stability analysis</h3>
<p>For the given model we compute <span class="math display">\[
H'(N_t)= \frac{\gamma}{1+N_t^2} + \frac{-2 \gamma N_t^2}{(1+N_t^2)^2}.
\]</span></p>
<section id="n0" class="level4">
<h4 class="anchored" data-anchor-id="n0"><span class="math inline">\(N^*\)</span>=0</h4>
<p>The stability of the fixed point <span class="math inline">\(N^*=0\)</span> is determined by <span class="math display">\[
H'(0)= \gamma.
\]</span> Hence if $ &lt;1$ the first fixed point is monotonically stable as <span class="math inline">\(0&lt;H'(0) &lt; 1\)</span>.</p>
<p>When <span class="math inline">\(\gamma &gt; 1\)</span> the second fixed point becomes biologically relevant and the first fixed point becomes monotonically unstable.</p>
</section>
<section id="nsqrtgamma-1" class="level4">
<h4 class="anchored" data-anchor-id="nsqrtgamma-1"><span class="math inline">\(N^*=\sqrt{\gamma-1}\)</span></h4>
<p>The stability of the second fixed point, <span class="math inline">\(N^*=\sqrt{\gamma-1}\)</span>, is determined by <span class="math display">\[
\begin{align}
H'(\sqrt{\gamma-1})&amp;= \frac{\gamma}{1+\gamma-1} + \frac{-2 \gamma (\gamma-1)}{(1+(\gamma-1))^2}, \nonumber \\
&amp;= \frac{2}{\gamma}-1.\nonumber
\end{align}
\]</span> Hence if <span class="math inline">\(N^*\)</span> were monotonically unstable, <span class="math display">\[
H'(\sqrt{\gamma-1}) = \frac{2}{\gamma}-1 &gt;1,
\]</span> and <span class="math display">\[
\gamma&lt;1.
\]</span> As a necessary condition for the biological relevance of <span class="math inline">\(N^*\)</span> is that <span class="math inline">\(\gamma&gt;1\)</span> we obtain a contradiction. Hence <span class="math inline">\(N^*\)</span>, if it is biologically relevant, cannot be monotonically unstable.</p>
<p>Suppose <span class="math inline">\(N^*\)</span> is monotonically stable. Then <span class="math display">\[
0&lt;H'(N^*) &lt;1
\]</span> which upon substitution yields <span class="math display">\[
0&lt;\frac{2}{\gamma}-1  &lt;1.
\]</span> Hence <span class="math inline">\(1&lt;\gamma&lt;2\)</span>. Suppose <span class="math inline">\(N^*\)</span> is oscillatory stable. Then <span class="math display">\[
-1&lt;H'(N^*) &lt;0
\]</span> which upon substitution yields <span class="math display">\[
-1&lt;\frac{2}{\gamma}-1  &lt; 0.
\]</span> Hence <span class="math inline">\(\gamma&gt;2\)</span>. \ Hence the linear stability of the fixed point <span class="math inline">\(N^*=\sqrt{\gamma-1}\)</span> depends on whether <span class="math inline">\(\gamma\)</span> lies in the range <span class="math inline">\([0,1]\)</span>, <span class="math inline">\([1,2 ]\)</span> or <span class="math inline">\([2,\infty]\)</span>.</p>
<p>Let’s annotate the diagram in the previous figure with the info. obtained from the linear stability analysis. Hence the interval <span class="math inline">\([0,\infty]\)</span> can be divided into distinct subintervals within which the linear stability of <span class="math inline">\(N^*\)</span> is conserved. The boundaries of subintervals are bifurcation values where a the stability of the fixed point changes.</p>
</section>
</section>
<section id="cobwebbing" class="level3">
<h3 class="anchored" data-anchor-id="cobwebbing">Cobwebbing</h3>
<p>In <a href="#fig-densmodelcobweb">Figure&nbsp;6</a> cobweb diagrams illustrate model behaviour in the three different parameter regimes. Note that the cobweb diagrams can be sketched by hand, given an accurate enough sketch of the right-hand side function <span class="math inline">\(H(N_t)\)</span>. Note also that the cobweb diagrams are consistent with the linear stability analysis but that the linear approximation is only valid close to the equilibrium point.</p>
<div class="cell" data-execution_count="6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>T<span class="op">=</span><span class="dv">10</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.arange(<span class="dv">0</span>, T, <span class="dv">1</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> np.zeros_like(t,dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>N_2 <span class="op">=</span> np.zeros_like(t,dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>N_0<span class="op">=</span><span class="fl">0.2</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>r_1<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>r_2<span class="op">=</span><span class="fl">1.5</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>r_3<span class="op">=</span><span class="fl">2.5</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>r_4<span class="op">=</span><span class="fl">3.5</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>N_max<span class="op">=</span><span class="fl">4.0</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rhs(x,r):</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  f<span class="op">=</span>r<span class="op">*</span>x<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> f</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> SolveSingleDiff(t,rhs,N_0,r):</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  N <span class="op">=</span> np.zeros_like(t,dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>  N[<span class="dv">0</span>]<span class="op">=</span>N_0</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  num_time_steps<span class="op">=</span>t.shape[<span class="dv">0</span>]</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>  CobwebSol<span class="op">=</span>np.zeros((<span class="dv">2</span><span class="op">*</span>num_time_steps,<span class="dv">2</span>))</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>  CobwebSol[<span class="dv">0</span>,<span class="dv">0</span>]<span class="op">=</span>N_0</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>  CobwebSol[<span class="dv">0</span>,<span class="dv">1</span>]<span class="op">=</span>rhs(N_0,r)</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>  CobwebSol[<span class="dv">1</span>,<span class="dv">0</span>]<span class="op">=</span>CobwebSol[<span class="dv">0</span>,<span class="dv">1</span>]</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>  CobwebSol[<span class="dv">1</span>,<span class="dv">1</span>]<span class="op">=</span>CobwebSol[<span class="dv">0</span>,<span class="dv">1</span>]</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> i <span class="kw">in</span> t:</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i<span class="op">&gt;</span><span class="dv">0</span>:</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>      N[i]<span class="op">=</span>rhs(N[i<span class="op">-</span><span class="dv">1</span>],r) </span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>      sol_temp<span class="op">=</span>N[i<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>      rhs_temp<span class="op">=</span>rhs(sol_temp,r)</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>      CobwebSol[<span class="dv">2</span><span class="op">*</span>i,<span class="dv">0</span>]<span class="op">=</span>sol_temp</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>      CobwebSol[<span class="dv">2</span><span class="op">*</span>i,<span class="dv">1</span>]<span class="op">=</span>rhs_temp</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>      CobwebSol[<span class="dv">2</span><span class="op">*</span>i<span class="op">+</span><span class="dv">1</span>,<span class="dv">0</span>]<span class="op">=</span>rhs_temp</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>      CobwebSol[<span class="dv">2</span><span class="op">*</span>i<span class="op">+</span><span class="dv">1</span>,<span class="dv">1</span>]<span class="op">=</span>rhs_temp</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> N, CobwebSol</span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>N1,CobwebSol1<span class="op">=</span>SolveSingleDiff(t,rhs,N_0,r_1)</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>N2,CobwebSol2<span class="op">=</span>SolveSingleDiff(t,rhs,N_0,r_2)</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>N3,CobwebSol3<span class="op">=</span>SolveSingleDiff(t,rhs,N_0,r_3)</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>N4,CobwebSol4<span class="op">=</span>SolveSingleDiff(t,rhs,N_0,r_4)</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>N_plot<span class="op">=</span>np.linspace(<span class="dv">0</span>,N_max,<span class="dv">100</span>)</span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>H_N_plot1<span class="op">=</span>rhs(N_plot,r_1)</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>H_N_plot2<span class="op">=</span>rhs(N_plot,r_2)</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>H_N_plot3<span class="op">=</span>rhs(N_plot,r_3)</span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>H_N_plot4<span class="op">=</span>rhs(N_plot,r_4)</span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>,<span class="dv">0</span>].plot(CobwebSol1[:,<span class="dv">0</span>], CobwebSol1[:,<span class="dv">1</span>])</span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>,<span class="dv">0</span>].plot(CobwebSol1[<span class="dv">0</span>,<span class="dv">0</span>], CobwebSol1[<span class="dv">0</span>,<span class="dv">1</span>],<span class="st">'*'</span>)</span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>,<span class="dv">0</span>].plot([<span class="dv">0</span>, N_max], [<span class="dv">0</span>, N_max])</span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>,<span class="dv">0</span>].plot(N_plot, H_N_plot1)</span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>,<span class="dv">1</span>].plot(CobwebSol2[:,<span class="dv">0</span>], CobwebSol2[:,<span class="dv">1</span>])</span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>,<span class="dv">1</span>].plot(CobwebSol2[<span class="dv">0</span>,<span class="dv">0</span>], CobwebSol2[<span class="dv">0</span>,<span class="dv">1</span>],<span class="st">'*'</span>)</span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>,<span class="dv">1</span>].plot([<span class="dv">0</span>, N_max], [<span class="dv">0</span>, N_max])</span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>,<span class="dv">1</span>].plot(N_plot, H_N_plot2)</span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">0</span>].plot(CobwebSol3[:,<span class="dv">0</span>], CobwebSol3[:,<span class="dv">1</span>])</span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">0</span>].plot(CobwebSol3[<span class="dv">0</span>,<span class="dv">0</span>], CobwebSol3[<span class="dv">0</span>,<span class="dv">1</span>],<span class="st">'*'</span>)</span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">0</span>].plot([<span class="dv">0</span>, N_max], [<span class="dv">0</span>, N_max])</span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">0</span>].plot(N_plot, H_N_plot3)</span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">1</span>].plot(CobwebSol4[:,<span class="dv">0</span>], CobwebSol4[:,<span class="dv">1</span>])</span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">1</span>].plot(CobwebSol4[<span class="dv">0</span>,<span class="dv">0</span>], CobwebSol4[<span class="dv">0</span>,<span class="dv">1</span>],<span class="st">'*'</span>)</span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">1</span>].plot([<span class="dv">0</span>, N_max], [<span class="dv">0</span>, N_max])</span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">1</span>].plot(N_plot, H_N_plot4)</span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$N_t$'</span>)</span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$N_{t+1}$'</span>)</span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-densmodelcobweb" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="MA32009-SinglePopDiscreteTimea_files/figure-html/fig-densmodelcobweb-output-1.png" width="558" height="431" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;6: Cobweb diagrams for different values of gamma.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="bifurcation-diagram" class="level3">
<h3 class="anchored" data-anchor-id="bifurcation-diagram">Bifurcation diagram</h3>
<p>Bifurcations at the critical values <span class="math inline">\(\gamma=1\)</span> and <span class="math inline">\(\gamma=2\)</span> are highlighted in the bifurcation diagram presented in <a href="#fig-densmodelbfc">Figure&nbsp;7</a>. Note that the bifurcation diagram allows classification of the different model behaviours in a single plot without explicitly calculating the solution to the model.</p>
<div class="cell" data-execution_count="7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>gam_plot<span class="op">=</span>np.linspace(<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">100</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>N_star_1<span class="op">=</span><span class="dv">0</span><span class="op">*</span>np.zeros_like(gam_plot)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>gam_plot2<span class="op">=</span>np.linspace(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">100</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>N_star_2<span class="op">=</span>np.sqrt(gam_plot2<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>ax.plot(gam_plot,N_star_1)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>ax.plot(gam_plot2,N_star_2)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$gamma$'</span>)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$N^*$'</span>)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-densmodelbfc" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="MA32009-SinglePopDiscreteTimea_files/figure-html/fig-densmodelbfc-output-1.png" width="599" height="429" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;7: A bifiurcation diagram.</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="an-application---how-much-harvesting-can-a-population-sustain" class="level1">
<h1>An application - how much harvesting can a population sustain?</h1>
<p>Models of population dynamics can be used to study how interventions will affect population dynamics. Extending from the model developed in the previous example, a valid question might be what is the maximal rate of harvesting a fish stock can sustain without becoming extinct? ## Including a harvesting term Introducing a harvesting term at per capita harvesting rate <span class="math inline">\(h\)</span>, the governing model equation becomes <span id="eq-harvestingmodel"><span class="math display">\[
N_{t+1}=\frac{\gamma N_t}{1+N_t^2} - h N_t,
\tag{6}\]</span></span></p>
<p>and the questions we want to ask are: (i) does the introduction of harvesting change the dynamics of the system?; and (ii) what rate of harvesting such a population could withstand?</p>
<section id="direct-simulation" class="level3">
<h3 class="anchored" data-anchor-id="direct-simulation">Direct simulation</h3>
<p>Based on the previous analysis we consider the system in a parameter regime where without harvesting there is a stable fixed point (<span class="math inline">\(\gamma&gt;1\)</span>).</p>
<div class="cell" data-execution_count="8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>T<span class="op">=</span><span class="dv">10</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.arange(<span class="dv">0</span>, T, <span class="dv">1</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>N_0<span class="op">=</span><span class="fl">0.1</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>gam<span class="op">=</span><span class="fl">5.0</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>h_1<span class="op">=</span><span class="fl">0.1</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>h_2<span class="op">=</span><span class="fl">1.0</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>h_3<span class="op">=</span><span class="fl">3.0</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rhs(x,r,h):</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  f<span class="op">=</span>r<span class="op">*</span>x<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">**</span><span class="dv">2</span>)<span class="op">-</span>h<span class="op">*</span>x</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> f</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> SolveSingleDiff(t,rhs,N_0,r,h):</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  N <span class="op">=</span> np.zeros_like(t,dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  N[<span class="dv">0</span>]<span class="op">=</span>N_0</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> i <span class="kw">in</span> t:</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i<span class="op">&gt;</span><span class="dv">0</span>:</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>      N[i]<span class="op">=</span>rhs(N[i<span class="op">-</span><span class="dv">1</span>],r,h) </span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> N</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>N_1<span class="op">=</span>SolveSingleDiff(t,rhs,N_0,gam,h_1)</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>N_2<span class="op">=</span>SolveSingleDiff(t,rhs,N_0,gam,h_2)</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>N_3<span class="op">=</span>SolveSingleDiff(t,rhs,N_0,gam,h_3)</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">3</span>)</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(t, N_1)</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$t$'</span>)</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$N_t$'</span>)</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(t, N_2)</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$t$'</span>)</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$N_t$'</span>)</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].plot(t, N_3)</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$t$'</span>)</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$N_t$'</span>)</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-plotdensmodelharvest" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="MA32009-SinglePopDiscreteTimea_files/figure-html/fig-plotdensmodelharvest-output-1.png" width="579" height="433" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;8: Time series solution for (a) <span class="math inline">\(g\)</span>=0.5 and (b) <span class="math inline">\(g\)</span>=1.5 and (c) <span class="math inline">\(g\)</span>=10.5.</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-plotdensmodelharvest">Figure&nbsp;8</a> time series solutions at increasing harvesting rates (<span class="math inline">\(h=0.1\)</span>, <span class="math inline">\(h=1\)</span>, <span class="math inline">\(h=3\)</span>) are presented. For low harvesting rates the system behaves almost identically to the no harvesting case but with an expected reduction in the fixed point value. However for intermediate harvesting the population undergoes oscillations. However, for further increased harvesting rates there appears again to be a stable fixed point.</p>
<p>Can analysis of the model help us understand how/why changes in solutions occur?</p>
</section>
<section id="fixed-points-2" class="level3">
<h3 class="anchored" data-anchor-id="fixed-points-2">Fixed points</h3>
<p>The fixed points of the system satisfy <span class="math display">\[
N^*=\frac{\gamma N^*}{1+{N^*}^2} - h N^*.
\]</span> Hence the fixed points are <span class="math display">\[
N^*=0
\]</span> and <span class="math display">\[
N^*=\sqrt{\frac{\gamma}{1+h}-1}.
\]</span> Note that harvesting lowers the population size of the non-zero fixed point (when it exists).</p>
<p>Can we deduce a condition that must hold on the parameters <span class="math inline">\(\gamma\)</span> and <span class="math inline">\(h\)</span> in order that there is a non trivial biologically relevant fixed point?</p>
<p>Requiring <span class="math display">\[
N^* &gt;0
\]</span> implies <span class="math display">\[
\frac{\gamma}{1+h}-1&gt;0
\]</span>.</p>
</section>
<section id="linear-stability-1" class="level3">
<h3 class="anchored" data-anchor-id="linear-stability-1">Linear stability</h3>
<p>The linear stability is determined by <span class="math display">\[
\begin{align}
H'(N_t)=\frac{\gamma }{1+{N_t}^2} - \frac{2\gamma N_t^2 }{(1+{N_t}^2)^2} - h.
\end{align}
\]</span> At <span class="math inline">\(N^*=0\)</span> we obtain <span class="math display">\[
H'(0)=\gamma-h.
\]</span> Hence if <span class="math inline">\(\gamma&gt;1+h\)</span>, <span class="math inline">\(N^*=0\)</span> is unstable.</p>
<p>Note that this is the condition that determines whether the non-zero fixed point exists or not.</p>
<p>At <span class="math display">\[
N^*=\sqrt{\frac{\gamma}{1+h}-1},
\]</span> <span class="math display">\[
\begin{align}
H'\left(\sqrt{\frac{\gamma}{1+h}-1}\right)=\frac{\gamma }{1+\frac{\gamma}{1+h}-1} - \frac{2\gamma \frac{\gamma}{1+h}-1 }{(1+\frac{\gamma}{1+h}-1)^2} - h.
\end{align}\
\]</span> Hence linear stability is a function of two parameters <span class="math inline">\(\gamma\)</span> and <span class="math inline">\(h\)</span>.</p>
<p>We can show that<br>
<span class="math display">\[
H'(N^*) = h^2\frac{2}{\gamma} + h\frac{2}{\gamma}(2-\gamma) + \frac{2}{\gamma}-1,
\]</span>{#harvestingH_prime} and hence that when <span class="math inline">\(h=0\)</span> we retrieve the stability condition from the previous model.</p>
<div class="cell" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>h_vec<span class="op">=</span>np.linspace(<span class="fl">0.1</span>,<span class="dv">5</span>,<span class="dv">100</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>gamma_1<span class="op">=</span>(<span class="dv">1</span><span class="op">+</span>h_vec)<span class="op">**</span><span class="dv">2</span><span class="op">/</span>h_vec</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>gamma_2<span class="op">=</span><span class="dv">1</span><span class="op">+</span>h_vec</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>gamma_3<span class="op">=</span>h_vec</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>ax.plot(h_vec, gamma_1)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>ax.plot(h_vec, gamma_2)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>ax.plot(h_vec, gamma_3)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$h$'</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$\gamma$'</span>)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-plotdensmodelharveststab" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="MA32009-SinglePopDiscreteTimea_files/figure-html/fig-plotdensmodelharveststab-output-1.png" width="585" height="429" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;9: Stability regions for the harvesting model.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="stability-boundaries-in-the-hgamma-plane" class="level3">
<h3 class="anchored" data-anchor-id="stability-boundaries-in-the-hgamma-plane">Stability boundaries in the <span class="math inline">\(h\gamma\)</span> plane</h3>
<p>The contour at <span class="math inline">\(H'(N^*)=1\)</span> can be identified by solving <span class="math display">\[
\begin{align}
h^2\frac{2}{\gamma} + h\frac{2}{\gamma}(2-\gamma) + \frac{2}{\gamma}-1 = 1,
\end{align}
\]</span> yielding <span class="math display">\[
\begin{align}
\gamma= 1+h.
\end{align}
\]</span></p>
<p>We can show that the contour at <span class="math inline">\(H'(N^*)=-1\)</span> can be represented by [ =. ]</p>
<p><span class="math display">\[
\begin{align}
h^2\frac{2}{\gamma} + h\frac{2}{\gamma}(2-\gamma) + \frac{2}{\gamma}-1 = -1,
\end{align}
\]</span> Solving for <span class="math inline">\(\gamma\)</span> yields <span class="math display">\[
\gamma=\frac{(1+h)^2}{h}.
\]</span></p>
<p>In Figure <a href="#fig-plotdensmodelharveststab">Figure&nbsp;9</a> we plot the contours of the hypersurface <span class="math inline">\(H'(N^*)\)</span> at the critical values of <span class="math inline">\(-1\)</span>, <span class="math inline">\(0\)</span> and 1. Note that the points in parameter space used to generate the simulation results in Figure <span class="math inline">\(\ref{HarvestingTimeSeries}\)</span> are <span class="math inline">\((h,\gamma)=(0.1,5)\)</span> <span class="math inline">\((h,\gamma)=(1,5)\)</span> and <span class="math inline">\((h,\gamma)=(3,5)\)</span>. \ Cobweb diagrams in different regions of parameter space are presented in Figure <span class="math inline">\(\ref{HarvestingCobweb}\)</span>. The plot in <a href="#fig-plotdensmodelharveststab">Figure&nbsp;9</a> can be used to explain why the model transfers from a stable fixed point, through oscillatory fixed point and back to a stable fixed point as the harvesting rate increases from 0.1, to <span class="math inline">\(1\)</span> and then 5?</p>
<div class="cell" data-execution_count="10">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>T<span class="op">=</span><span class="dv">10</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.arange(<span class="dv">0</span>, T, <span class="dv">1</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> np.zeros_like(t,dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>N_2 <span class="op">=</span> np.zeros_like(t,dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>N_0<span class="op">=</span><span class="fl">0.2</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>h_1<span class="op">=</span><span class="fl">0.1</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>h_2<span class="op">=</span><span class="fl">1.0</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>h_3<span class="op">=</span><span class="fl">3.0</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>r<span class="op">=</span><span class="fl">5.0</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>N_max<span class="op">=</span><span class="fl">4.0</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rhs(x,r,h):</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  f<span class="op">=</span>r<span class="op">*</span>x<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">**</span><span class="dv">2</span>)<span class="op">-</span>h<span class="op">*</span>x</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> f</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> SolveSingleDiff(t,rhs,N_0,r,h):</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  N <span class="op">=</span> np.zeros_like(t,dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  N[<span class="dv">0</span>]<span class="op">=</span>N_0</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>  num_time_steps<span class="op">=</span>t.shape[<span class="dv">0</span>]</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>  CobwebSol<span class="op">=</span>np.zeros((<span class="dv">2</span><span class="op">*</span>num_time_steps,<span class="dv">2</span>))</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>  CobwebSol[<span class="dv">0</span>,<span class="dv">0</span>]<span class="op">=</span>N_0</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>  CobwebSol[<span class="dv">0</span>,<span class="dv">1</span>]<span class="op">=</span>rhs(N_0,r,h)</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>  CobwebSol[<span class="dv">1</span>,<span class="dv">0</span>]<span class="op">=</span>CobwebSol[<span class="dv">0</span>,<span class="dv">1</span>]</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>  CobwebSol[<span class="dv">1</span>,<span class="dv">1</span>]<span class="op">=</span>CobwebSol[<span class="dv">0</span>,<span class="dv">1</span>]</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> i <span class="kw">in</span> t:</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i<span class="op">&gt;</span><span class="dv">0</span>:</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>      N[i]<span class="op">=</span>rhs(N[i<span class="op">-</span><span class="dv">1</span>],r,h) </span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>      sol_temp<span class="op">=</span>N[i<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>      rhs_temp<span class="op">=</span>rhs(sol_temp,r,h)</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>      CobwebSol[<span class="dv">2</span><span class="op">*</span>i,<span class="dv">0</span>]<span class="op">=</span>sol_temp</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>      CobwebSol[<span class="dv">2</span><span class="op">*</span>i,<span class="dv">1</span>]<span class="op">=</span>rhs_temp</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>      CobwebSol[<span class="dv">2</span><span class="op">*</span>i<span class="op">+</span><span class="dv">1</span>,<span class="dv">0</span>]<span class="op">=</span>rhs_temp</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>      CobwebSol[<span class="dv">2</span><span class="op">*</span>i<span class="op">+</span><span class="dv">1</span>,<span class="dv">1</span>]<span class="op">=</span>rhs_temp</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> N, CobwebSol</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>N1,CobwebSol1<span class="op">=</span>SolveSingleDiff(t,rhs,N_0,r,h_1)</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>N2,CobwebSol2<span class="op">=</span>SolveSingleDiff(t,rhs,N_0,r,h_2)</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>N3,CobwebSol3<span class="op">=</span>SolveSingleDiff(t,rhs,N_0,r,h_3)</span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>N_plot<span class="op">=</span>np.linspace(<span class="dv">0</span>,N_max,<span class="dv">100</span>)</span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>H_N_plot1<span class="op">=</span>rhs(N_plot,r,h_1)</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>H_N_plot2<span class="op">=</span>rhs(N_plot,r,h_2)</span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>H_N_plot3<span class="op">=</span>rhs(N_plot,r,h_3)</span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">3</span>)</span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(CobwebSol1[:,<span class="dv">0</span>], CobwebSol1[:,<span class="dv">1</span>])</span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(CobwebSol1[<span class="dv">0</span>,<span class="dv">0</span>], CobwebSol1[<span class="dv">0</span>,<span class="dv">1</span>],<span class="st">'*'</span>)</span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot([<span class="dv">0</span>, N_max], [<span class="dv">0</span>, N_max])</span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(N_plot, H_N_plot1)</span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(CobwebSol2[:,<span class="dv">0</span>], CobwebSol2[:,<span class="dv">1</span>])</span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(CobwebSol2[<span class="dv">0</span>,<span class="dv">0</span>], CobwebSol2[<span class="dv">0</span>,<span class="dv">1</span>],<span class="st">'*'</span>)</span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot([<span class="dv">0</span>, N_max], [<span class="dv">0</span>, N_max])</span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(N_plot, H_N_plot2)</span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].plot(CobwebSol3[:,<span class="dv">0</span>], CobwebSol3[:,<span class="dv">1</span>])</span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].plot(CobwebSol3[<span class="dv">0</span>,<span class="dv">0</span>], CobwebSol3[<span class="dv">0</span>,<span class="dv">1</span>],<span class="st">'*'</span>)</span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].plot([<span class="dv">0</span>, N_max], [<span class="dv">0</span>, N_max])</span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].plot(N_plot, H_N_plot3)</span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$N_t$'</span>)</span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$N_{t+1}$'</span>)</span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-densharvestingmodelcobweb" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="MA32009-SinglePopDiscreteTimea_files/figure-html/fig-densharvestingmodelcobweb-output-1.png" width="571" height="431" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;10: Cobweb diagrams for different values of h.</figcaption>
</figure>
</div>
</div>
</div>
<p>We can construct a cobweb diagram for the case <span class="math inline">\((h,\gamma)=(3,5)\)</span>.</p>
</section>
<section id="a-note-on-the-modelling-of-real-world-fish-stocks" class="level2">
<h2 class="anchored" data-anchor-id="a-note-on-the-modelling-of-real-world-fish-stocks">A note on the modelling of real-world fish stocks</h2>
<p>You can find reports on fish stocks (measurements and modelling work) from the International Council for the Exploration of the Sea at the link http://www.ices.dk/Pages/default.aspx. Here’s a link to the data for Atlantic salmon https://tinyurl.com/ya8sh72j. Note that although the models we have worked on are not detailed enough to accurately model real fish population dynamics, many of the principles we have covered arise in the cutting edge models.</p>
</section>
<section id="oscillations" class="level2">
<h2 class="anchored" data-anchor-id="oscillations">Oscillations</h2>
<p>Linear stability analysis describes the evolution of small perturbations close to a fixed point. But far from a fixed point the nonlinear terms that were dropped in a Taylor expansion are no longer negligible. In particular, in the case where <span class="math inline">\(H'(N^*)&lt;-1\)</span>, it can be the case that regions of parameter space in which a fixed point is oscillatory unstable can give rise to periodic and chaotic solutions.<br>
### Defining a periodic solution Consider the general form <span id="eq-genformagain"><span class="math display">\[
N_{t+1}=H(N_t)
\tag{7}\]</span></span> A solution to <a href="#eq-genformagain">Equation&nbsp;7</a> isdefined to be periodic with period <span class="math inline">\(T\)</span> if <span class="math display">\[
\begin{align}
N_{t+T}&amp;=N_t \ \  \forall t, \\
N_{t+\tau}&amp;\neq N_t  \ \ \forall t, \  \ \ \tau&lt;T.
\end{align}
\]</span> Period 2 solutions can be identified by looking for solutions that repeat after two iterations. Suppose <span class="math inline">\(\bar{N}\)</span> is a period 2 solution of <a href="#eq-genformagain">Equation&nbsp;7</a> and let <span class="math inline">\(\bar{N}=N_1\)</span>. Then <span class="math display">\[
N_{2}=H(\bar{N}).
\]</span> However, <span class="math display">\[
N_{3}=H(N_2)=H(H(\bar{N}))
\]</span> and if <span class="math inline">\(\bar{N}\)</span> is a period 2 solution <span class="math inline">\(N_3=N_1=\bar{N}\)</span>. Hence period 2 solutions can be calculated by solving the algebraic equation <span class="math display">\[
\bar{N}=H(H(\bar{N})).
\]</span> Note that period two solutions are fixed points of the problem <span class="math display">\[
N_{t+2}=H^2(N_t)=g(N_t).
\]</span> Using the tools we have developed, period solutions and their stability can be determined. Furthermore, longer period solutions can be identified by generalising the argument but at the expense of ever increasingly complicated right-hand side functions. In many systems, such as the harvesting model and the logistic equation, increasing the growth rate parameter leads initially to the fixed point becoming unstable and the emergence of period two solutions, then period 4 solutions and so on until eventually there is a transition to chaotic solutions (see, for example, <a href="#fig-densharvestingmodelcobwebp4">Figure&nbsp;11</a>).</p>
<div class="cell" data-execution_count="11">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>T<span class="op">=</span><span class="dv">40</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.arange(<span class="dv">0</span>, T, <span class="dv">1</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> np.zeros_like(t,dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>N_2 <span class="op">=</span> np.zeros_like(t,dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>N_0<span class="op">=</span><span class="fl">0.1</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>r_1<span class="op">=</span><span class="fl">9.68</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>r_2<span class="op">=</span><span class="fl">12.221</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>r_3<span class="op">=</span><span class="fl">30.25</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>h<span class="op">=</span><span class="fl">0.1</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>N_max<span class="op">=</span><span class="fl">20.0</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rhs(x,r,h):</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  f<span class="op">=</span>r<span class="op">*</span>x<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">**</span><span class="dv">2</span>)<span class="op">-</span>h<span class="op">*</span>x</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> f</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> SolveSingleDiff(t,rhs,N_0,r,h):</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>  N <span class="op">=</span> np.zeros_like(t,dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>  N[<span class="dv">0</span>]<span class="op">=</span>N_0</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>  num_time_steps<span class="op">=</span>t.shape[<span class="dv">0</span>]</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>  CobwebSol<span class="op">=</span>np.zeros((<span class="dv">2</span><span class="op">*</span>num_time_steps,<span class="dv">2</span>))</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>  CobwebSol[<span class="dv">0</span>,<span class="dv">0</span>]<span class="op">=</span>N_0</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>  CobwebSol[<span class="dv">0</span>,<span class="dv">1</span>]<span class="op">=</span>rhs(N_0,r,h)</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>  CobwebSol[<span class="dv">1</span>,<span class="dv">0</span>]<span class="op">=</span>CobwebSol[<span class="dv">0</span>,<span class="dv">1</span>]</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>  CobwebSol[<span class="dv">1</span>,<span class="dv">1</span>]<span class="op">=</span>CobwebSol[<span class="dv">0</span>,<span class="dv">1</span>]</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> i <span class="kw">in</span> t:</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i<span class="op">&gt;</span><span class="dv">0</span>:</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>      N[i]<span class="op">=</span>rhs(N[i<span class="op">-</span><span class="dv">1</span>],r,h) </span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>      sol_temp<span class="op">=</span>N[i<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>      rhs_temp<span class="op">=</span>rhs(sol_temp,r,h)</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>      CobwebSol[<span class="dv">2</span><span class="op">*</span>i,<span class="dv">0</span>]<span class="op">=</span>sol_temp</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>      CobwebSol[<span class="dv">2</span><span class="op">*</span>i,<span class="dv">1</span>]<span class="op">=</span>rhs_temp</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>      CobwebSol[<span class="dv">2</span><span class="op">*</span>i<span class="op">+</span><span class="dv">1</span>,<span class="dv">0</span>]<span class="op">=</span>rhs_temp</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>      CobwebSol[<span class="dv">2</span><span class="op">*</span>i<span class="op">+</span><span class="dv">1</span>,<span class="dv">1</span>]<span class="op">=</span>rhs_temp</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> N, CobwebSol</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>N1,CobwebSol1<span class="op">=</span>SolveSingleDiff(t,rhs,N_0,r_1,h)</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>N2,CobwebSol2<span class="op">=</span>SolveSingleDiff(t,rhs,N_0,r_2,h)</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>N3,CobwebSol3<span class="op">=</span>SolveSingleDiff(t,rhs,N_0,r_3,h)</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>N_plot<span class="op">=</span>np.linspace(<span class="dv">0</span>,N_max,<span class="dv">100</span>)</span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>H_N_plot1<span class="op">=</span>rhs(N_plot,r_1,h)</span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>H_N_plot2<span class="op">=</span>rhs(N_plot,r_2,h)</span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>H_N_plot3<span class="op">=</span>rhs(N_plot,r_3,h)</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>,<span class="dv">0</span>].plot(t, N1)</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>,<span class="dv">1</span>].plot(CobwebSol1[:,<span class="dv">0</span>], CobwebSol1[:,<span class="dv">1</span>])</span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>,<span class="dv">1</span>].plot(CobwebSol1[<span class="dv">0</span>,<span class="dv">0</span>], CobwebSol1[<span class="dv">0</span>,<span class="dv">1</span>],<span class="st">'*'</span>)</span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>,<span class="dv">1</span>].plot([<span class="dv">0</span>, N_max], [<span class="dv">0</span>, N_max])</span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>,<span class="dv">1</span>].plot(N_plot, H_N_plot1)</span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">0</span>].plot(t, N2)</span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">1</span>].plot(CobwebSol2[:,<span class="dv">0</span>], CobwebSol2[:,<span class="dv">1</span>])</span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">1</span>].plot(CobwebSol2[<span class="dv">0</span>,<span class="dv">0</span>], CobwebSol2[<span class="dv">0</span>,<span class="dv">1</span>],<span class="st">'*'</span>)</span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">1</span>].plot([<span class="dv">0</span>, N_max], [<span class="dv">0</span>, N_max])</span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">1</span>].plot(N_plot, H_N_plot2)</span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>,<span class="dv">0</span>].plot(t, N3)</span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>,<span class="dv">1</span>].plot(CobwebSol3[:,<span class="dv">0</span>], CobwebSol3[:,<span class="dv">1</span>])</span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>,<span class="dv">1</span>].plot(CobwebSol3[<span class="dv">0</span>,<span class="dv">0</span>], CobwebSol3[<span class="dv">0</span>,<span class="dv">1</span>],<span class="st">'*'</span>)</span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>,<span class="dv">1</span>].plot([<span class="dv">0</span>, N_max], [<span class="dv">0</span>, N_max])</span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>,<span class="dv">1</span>].plot(N_plot, H_N_plot3)</span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$N_t$'</span>)</span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$N_{t+1}$'</span>)</span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-densharvestingmodelcobwebp4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="MA32009-SinglePopDiscreteTimea_files/figure-html/fig-densharvestingmodelcobwebp4-output-1.png" width="566" height="431" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;11: Transition form period 2 to period 4 solutions in the harvesting model</figcaption>
</figure>
</div>
</div>
</div>
<p>Exercise: identify an equation satisfied by period 2 solutions of the logistic map <span class="math display">\[
N_{t+1}=rN_1(1-N_t).
\]</span></p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>